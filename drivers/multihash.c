#include <stdio.h>
#include <stdint.h>
#include <string.h>

// gcc ../xx/source.c main.c -lgmp -fno-stack-protector

void ECDSA_256_sign(unsigned char sig[64], const unsigned char hash[32]);

int main(int argc, char *argv[]) {
    if (argc != 2) {
        return 1;
    }
    const uint8_t hash1[32] = {
        0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
        0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa
    };
    const uint8_t hash2[32] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    uint8_t sig[64];

    if (strcmp(argv[1], "0") == 0) {
        ECDSA_256_sign(sig, hash1);
    } else {
        ECDSA_256_sign(sig, hash2);

    }

    for (int i = 0; i < 64; i++) {
        printf("%02X", sig[i]);
    }
    return 0;
}
